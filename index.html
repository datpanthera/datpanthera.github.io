<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bá»©c thÆ° gá»­i cho em â¤ï¸</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <!-- NÃºt Ä‘iá»u khiá»ƒn nháº¡c ná»n -->
    <button id="music-control">ğŸµ</button>

    <!-- Nháº¡c ná»n -->
    <audio id="background-music" loop>
        <source src="./music.mp3" type="audio/mpeg">
    </audio>

    <!-- Cáº¥u trÃºc cho phong bÃ¬ ban Ä‘áº§u -->
    <div id="envelope-container">
        <div class="envelope">
            <!-- ThÃªm táº¥m áº£nh sáº½ trÆ°á»£t ra -->
            <div class="envelope-flap"></div>
            <div class="envelope-body"></div>
            <div class="envelope-heart"><img src="./heart.png" alt="TrÃ¡i tim"></div>
        </div>
        <p class="envelope-instruction">Click Ä‘á»ƒ má»Ÿ thÆ°</p>
    </div>

    <div class="container" id="mainContainer" style="visibility: hidden; opacity: 0;">
        <!-- Cáº£nh 1: Lá»i chÃºc 20/10 -->
        <div id="scene-1" class="scene">
            <h1>ğŸŒ¸ Gá»­i Trang yÃªu dáº¥u</h1>
            <p>HÃ´m nay lÃ  ngÃ y 20/10, nhÆ° bao ngÆ°á»i Ä‘Ã n Ã´ng khÃ¡c, anh muá»‘n gá»­i Ä‘áº¿n em nhá»¯ng lá»i chÃºc chÃ¢n thÃ nh nháº¥t.</p>
            <p>ChÃºc em luÃ´n xinh Ä‘áº¹p, ráº¡ng rá»¡ vÃ  háº¡nh phÃºc. Mong ráº±ng má»i Ä‘iá»u tá»‘t Ä‘áº¹p nháº¥t sáº½ Ä‘áº¿n vá»›i em â€” trong há»c táº­p, cÃ´ng viá»‡c vÃ  cuá»™c sá»‘ng. ChÃºc em cÃ³ má»™t ngÃ y Phá»¥ ná»¯ Viá»‡t Nam tháº­t vui váº», trÃ n ngáº­p hoa, quÃ  vÃ  nhá»¯ng lá»i yÃªu thÆ°Æ¡ng.</p>
            <p>NhÃ¢n dá»‹p nÃ y, anh cÅ©ng muá»‘n nÃ³i ra Ä‘iá»u mÃ  anh Ä‘Ã£ giá»¯ trong lÃ²ng suá»‘t báº¥y lÃ¢u nay.</p>
            <div class="buttons">
                <span class="continue-text">Tiáº¿p tá»¥c &rarr;</span>
            </div>
        </div>

        <!-- Cáº£nh 2: Há»“i á»©c tuá»•i thÆ¡ -->
        <div id="scene-2" class="scene hidden">
            <h1>ğŸŒ¸ Tuá»•i thÆ¡ há»“n nhiÃªn</h1>
            <p>Thá»i gian trÃ´i tháº­t nhanh. Anh biáº¿t em tá»« khi em cÃ²n há»c lá»›p 1, há»“i máº¹ em dáº«n Ä‘i sinh hoáº¡t hÃ¨ á»Ÿ Äá»“ng TÃ¢m. Khi Ä‘Ã³ anh gá»i em lÃ  â€œcon lá»£n cÃ²iâ€, cÃ²n em cÅ©ng gá»i anh lÃ  cÃ¡i gÃ¬ Ä‘Ã³ mÃ  anh quÃªn máº¥t rá»“i. Há»“i Ä‘Ã³ Ä‘áº¥m Ä‘Ã¡ chÃ­ choÃ© nhau suá»‘t, anh thÃ¬ thÃ¹ dai nhá»› nhÆ° in bá»‹ em cáº¥u cháº£y mÃ¡u.</p>
            <div class="buttons">
                <span class="continue-text">Gáº·p láº¡i... &rarr;</span>
            </div>
        </div>

        <!-- Cáº£nh 3: Gáº·p láº¡i lá»›p 7 -->
        <div id="scene-3" class="scene hidden">
            <h1>âœ¨ Láº§n gáº·p láº¡i Ä‘áº§u tiÃªn</h1>
            <p>Äáº¿n táº­n lÃºc em lá»›p 6, em má»›i quen láº¡i anh â€” khi tÃ¬nh cá» gáº·p nhau máº·c dÃ¹ em cháº£ nhá»› gÃ¬ cáº£. HÃ¬nh nhÆ° lÃºc Ä‘Ã³ anh váº«n tiáº¿p tá»¥c trÃªu em thÃ¬ pháº£i, cháº¯c lÃ  cÃ¡i táº­t trÃªu gÃ¡i ngáº¥m vÃ o mÃ¡u rá»“i. Giá» thÃ¬ háº¿t rá»“i, khÃ´ng cÃ²n nhÆ° ngÃ y xÆ°a ná»¯a nhÆ°ng nhá» váº­y mÃ  hai Ä‘á»©a cÃ³ cÆ¡ há»™i trÃ² chuyá»‡n vá»›i nhau.</p>
            <div class="buttons">
                <span class="continue-text">Sau Ä‘Ã³... &rarr;</span>
            </div>
        </div>

        <!-- Cáº£nh 4: Thá»i Covid -->
        <div id="scene-4" class="scene hidden">
            <h1>ğŸ˜· Thá»i Covid</h1>
            <p>Rá»“i Ä‘áº¿n thá»i Covid, mÃ¬nh láº¡i vÃ´ tÃ¬nh gáº·p nhau khi Ä‘i Ä‘Ã¡nh bÃ³ng. CÃ³ láº½ khoáº£ng thá»i gian Ä‘Ã³ khiáº¿n hai Ä‘á»©a trá»Ÿ nÃªn thÃ¢n thiáº¿t hÆ¡n bao giá» háº¿t. Tá»« Ä‘Ã³, nhá»¯ng tin nháº¯n Ä‘áº§u tiÃªn Ä‘Æ°á»£c gá»­i Ä‘i â€” vÃ  anh cáº£m nháº­n Ä‘Æ°á»£c má»™t Ä‘iá»u gÃ¬ Ä‘Ã³ ráº¥t trong sÃ¡ng, ráº¥t tá»± nhiÃªn tá»« cáº£ hai. Gáº§n Ä‘Ã¢y anh cÃ³ Ä‘á»c láº¡i nhá»¯ng tin nháº¯n ngÃ y áº¥y, vÃ  tháº­t sá»± khÃ´ng ngá» ráº±ng mÃ¬nh tá»«ng cÃ³ thá»ƒ chia sáº» má»i thá»© má»™t cÃ¡ch vÃ´ tÆ° nhÆ° váº­y.</p>
            <p>Giá» Ä‘Ã¢y, anh ráº¥t khÃ³ Ä‘á»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³ vá»›i báº¥t ká»³ ai khÃ¡c. NhÆ°ng rá»“i, chÃºng mÃ¬nh láº¡i dá»«ng láº¡i â€” má»™t cÃ¡ch khÃ³ hiá»ƒu, do anh cÅ©ng khÃ´ng tiáº¿p tá»¥c chia sáº» hay nháº¯n gÃ¬ vá»›i em ná»¯a.</p>
            <div class="buttons">
                <span class="continue-text">Thá»i gian sau Ä‘Ã³... &rarr;</span>
            </div>
        </div>

        <!-- Cáº£nh 5: Gáº·p láº¡i trÃªn xe bus -->
        <div id="scene-5" class="scene hidden">
            <h1>ğŸ’­ Khoáº£ng láº·ng giá»¯a hai ta</h1>
            <p>Sau Ä‘Ã³, Ä‘Ã´i lÃºc anh vÃ  em váº«n gáº·p nhau, nhÆ° trÃªn xe buÃ½t hay khi em Ä‘i Ä‘Ã¡nh cáº§u lÃ´ng, nhÆ°ng cÅ©ng chá»‰ dá»«ng láº¡i á»Ÿ nhá»¯ng lá»i chÃ o há»i. Tháº­t lÃ²ng, anh khÃ´ng biáº¿t pháº£i nÃ³i gÃ¬ vá»›i em.</p>
            <p>Anh vá»‘n khÃ´ng giá»i thá»ƒ hiá»‡n cáº£m xÃºc tháº­t, thÆ°á»ng giá»¯ thÃ¡i Ä‘á»™ trung láº­p khi á»Ÿ ngoÃ i xÃ£ há»™i, cho Ä‘áº¿n táº­n bÃ¢y giá» váº«n váº­y. NhÆ°ng lÃºc áº¥y, anh ngáº¡i láº¯m â€” má»™t pháº§n vÃ¬ nhá»¯ng lá»i há»©a vá»›i em, má»™t pháº§n vÃ¬ chÆ°a Ä‘á»§ can Ä‘áº£m Ä‘á»ƒ Ä‘á»‘i diá»‡n vá»›i em.</p>
            <div class="buttons">
                <span class="continue-text">VÃ  Ä‘á»‹nh má»‡nh... &rarr;</span>
            </div>
        </div>

        <!-- Cáº£nh 6: Dá»‹p A80 -->
        <div id="scene-6" class="scene hidden">
            <h1>ğŸ’« DuyÃªn pháº­n láº¡i má»‰m cÆ°á»i</h1>
            <p>Rá»“i má»™t Ä‘iá»u khÃ´ng ngá» Ä‘Ã£ xáº£y ra â€” dá»‹p A80, dip quan trá»ng cá»§a Ä‘áº¥t nÆ°á»›c, em vÃ o Ä‘áº¡i há»c, anh cÅ©ng vá»«a tá»‘t nghiá»‡p Ä‘áº¡i há»c. Tháº­t trÃ¹ng há»£p, má»™t láº§n ná»¯a chÃºng ta láº¡i gáº·p nhau á»Ÿ nhá»¯ng dáº¥u má»‘c quan trá»ng cá»§a cuá»™c Ä‘á»i. TrÃ²n bá»‘n nÄƒm rá»“i, vÃ  thÃªm má»™t láº§n ná»¯a, anh vá»›i em láº¡i cÃ³ thá»ƒ trÃ² chuyá»‡n â€” khÃ´ng cÃ²n vÃ´ tÆ°, há»“n nhiÃªn nhÆ° trÆ°á»›c mÃ  thay vÃ o Ä‘Ã³ lÃ  sá»± nháº¹ nhÃ ng, xen láº«n chÃºt ngÆ°á»£ng ngÃ¹ng. Tháº­t sá»±, trÃ¡i tim anh láº¡i Ä‘áº­p rá»™n rÃ ng má»™t láº§n ná»¯a.</p>
            <div class="buttons">
                <span class="continue-text">Lá»i anh muá»‘n nÃ³i... &rarr;</span>
            </div>
        </div>

        <!-- Cáº£nh 7: Lá»i tá» tÃ¬nh -->
        <div id="scene-7" class="scene hidden">
            <h1>â¤ï¸ Lá»i anh muá»‘n nÃ³i</h1>
            <p>Thá»i gian bÃªn nhau khÃ´ng dÃ i, nhÆ°ng Ä‘á»§ Ä‘á»ƒ khÆ¡i dáº­y trong anh nhá»¯ng cáº£m xÃºc ráº¥t tháº­t, ráº¥t khÃ³ táº£. Anh báº¯t Ä‘áº§u nhá»›, báº¯t Ä‘áº§u muá»‘n quan tÃ¢m, chÄƒm sÃ³c, yÃªu thÆ°Æ¡ng em â€” nhÆ° má»™t báº£n nÄƒng. Ban Ä‘áº§u anh nghÄ© chá»‰ mÃ¬nh anh cáº£m tháº¥y váº­y, nhÆ°ng khi nháº­n ra em cÅ©ng Ä‘ang Ä‘Ã³n nháº­n, anh thá»±c sá»± ráº¥t vui. Cuá»™c sá»‘ng cá»§a anh lÃ  chuá»—i ngÃ y báº­n rá»™n vÃ  nhiá»u Ã¡p lá»±c, Ä‘Ã´i khi khiáº¿n anh má»‡t má»i, nhÆ°ng chá»‰ cáº§n á»Ÿ cáº¡nh em, má»i thá»© nhÆ° dá»‹u láº¡i, nháº¹ nhÃµm vÃ  bÃ¬nh yÃªn hÆ¡n bao giá» háº¿t. ÄÆ°á»£c tháº¥y em vui, anh cÅ©ng cáº£m tháº¥y ráº¥t háº¡nh phÃºc.</p>
            <p>Anh yÃªu em, vÃ  anh chá»‰ mong Ä‘Æ°á»£c á»Ÿ bÃªn Ä‘á»ƒ quan tÃ¢m, chÄƒm sÃ³c, yÃªu thÆ°Æ¡ng em má»—i ngÃ y. Anh cÃ³ thá»ƒ khÃ´ng quÃ¡ lÃ£ng máº¡n, cÅ©ng cháº³ng giá»i nÃ³i nhá»¯ng lá»i ngá»t ngÃ o, nhÆ°ng anh tin ráº±ng tÃ¬nh cáº£m, táº¥m lÃ²ng vÃ  sá»± chÃ¢n thÃ nh cá»§a anh lÃ  tháº­t lÃ²ng â€” vÃ  Ä‘á»§ Ä‘á»ƒ em cáº£m nháº­n Ä‘Æ°á»£c. CÃ³ thá»ƒ em cho ráº±ng anh nÃ³i hÆ¡i quÃ¡ nhÆ°ng thá»i gian sáº½ chá»©ng minh táº¥t cáº£.</p>
            <p>Anh biáº¿t cÅ©ng cÃ³ thá»ƒ cÃ²n quÃ¡ sá»›m nhÆ°ng cÅ©ng cÃ³ thá»ƒ Ä‘Ã£ quÃ¡ muá»™n, nhÆ°ng anh khÃ´ng muá»‘n há»‘i tiáº¿c gÃ¬ ná»¯a.</p>
            <h2>Em Ä‘á»“ng Ã½ lÃ m ngÆ°á»i yÃªu anh nhÃ©?</h2>
            <div class="buttons">
            </div>
        </div>

    </div>

    <form id="google-form" class="hidden">
        <input type="text" name="entry.YOUR_ENTRY_ID" value="Äá»“ng Ã½">
    </form>

    <script>
        const scenes = Array.from(document.querySelectorAll('.scene'));
        const continueTexts = document.querySelectorAll('.continue-text');
        const mainContainer = document.getElementById('mainContainer');
        const envelopeContainer = document.getElementById('envelope-container');
        const music = document.getElementById('background-music');
        const musicControlBtn = document.getElementById('music-control');
        let isTyping = false;
        let autoAdvanceTimer = null;
        let currentScene = 0;
        
        function moveToNextScene() {
            if (isTyping || currentScene >= scenes.length - 1) return;
            advanceScene();
        }

        function submitToGoogleForm() {
            const form = document.getElementById('google-form');
            const formURL = 'https://docs.google.com/forms/d/e/LONG_RANDOM_STRING/formResponse';
            const entryID = 'entry.1234567890'; // Thay báº±ng entry ID tháº­t cá»§a báº¡n

            const formData = new FormData(form);
            formData.set(entryID, 'Äá»“ng Ã½');

            fetch(formURL, {
                method: 'POST',
                body: formData,
                mode: 'no-cors'
            }).catch(error => console.error('Error!', error.message));
        }

        // --- Logic cho hiá»‡u á»©ng gÃµ chá»¯ ---

        // HÃ m gÃµ chá»¯
        function typeEffect(element, text, speed = 50) { // TÄƒng thá»i gian chá» máº·c Ä‘á»‹nh
            return new Promise(resolve => {
                let i = 0;
                element.innerHTML = '';
                const cursor = document.createElement('span');
                cursor.className = 'typing-cursor';
                element.appendChild(cursor);

                function typing() {
                    if (i < text.length) {
                        cursor.insertAdjacentText('beforebegin', text.charAt(i));
                        i++;
                        setTimeout(typing, speed);
                    } else {
                        cursor.remove(); // XÃ³a con trá» khi gÃµ xong
                        resolve();
                    }
                }
                typing();
            });
        }

        // HÃ m báº¯t Ä‘áº§u gÃµ chá»¯ cho má»™t cáº£nh cá»¥ thá»ƒ
        async function startTypingForScene(sceneElement) {
            const h1 = sceneElement.querySelector('h1');
            const paragraphs = sceneElement.querySelectorAll('p');
            const h2 = sceneElement.querySelector('h2'); // ThÃªm h2 cho cáº£nh cuá»‘i
            const buttonContainer = sceneElement.querySelector('.buttons');
            
            isTyping = true;

            // Chuáº©n bá»‹ cÃ¡c pháº§n tá»­ cáº§n gÃµ chá»¯
            const elementsToType = [];
            paragraphs.forEach(p => elementsToType.push({ el: p, text: p.textContent, speed: 50 })); // Cháº­m láº¡i tá»« 40ms -> 50ms
            if (h2) elementsToType.push({ el: h2, text: h2.textContent, speed: 63 }); // Cháº­m láº¡i tá»« 50ms -> ~63ms

            // áº¨n nÃºt vÃ  xÃ³a ná»™i dung Ä‘á»ƒ chuáº©n bá»‹ gÃµ
            if (buttonContainer) {
                buttonContainer.style.opacity = '0';
                // buttonContainer.style.pointerEvents = 'none';
            }
            elementsToType.forEach(item => item.el.innerHTML = '');

            // Xá»­ lÃ½ riÃªng cho h1: thÃªm hiá»‡u á»©ng vÃ  hiá»ƒn thá»‹ ngay
            if (h1) {
                h1.style.opacity = '0'; // áº¨n Ä‘i Ä‘á»ƒ animation cháº¡y
                h1.classList.add('title-animate');
            }

            // Báº¯t Ä‘áº§u gÃµ tuáº§n tá»±
            for (const item of elementsToType) {
                await typeEffect(item.el, item.text, item.speed);
            }

            isTyping = false;

            // Sau khi gÃµ chá»¯ xong, kiá»ƒm tra xem nÃªn lÃ m gÃ¬ tiáº¿p theo
            if (buttonContainer) { // Náº¿u lÃ  cÃ¡c cáº£nh cÃ³ text "Tiáº¿p tá»¥c"
                const continueText = buttonContainer.querySelector('.continue-text');
                if (continueText) showButtonsAndStartCountdown(buttonContainer, continueText);
            }
        }

        function showButtonsAndStartCountdown(buttonContainer, continueText) {
            buttonContainer.style.transition = 'opacity 0.5s';
            buttonContainer.style.opacity = '1';
            buttonContainer.style.pointerEvents = 'auto';
            startCountdown(continueText);
        }

        function clearCountdown() {
            if (autoAdvanceTimer) {
                clearInterval(autoAdvanceTimer);
                autoAdvanceTimer = null;
            }
        }

        // HÃ m Ä‘áº¿m ngÆ°á»£c tá»± Ä‘á»™ng chuyá»ƒn cáº£nh
        function startCountdown(element) {
            let countdown = 3;
            const originalText = element.textContent.replace(/ \(\d\)$/, '').replace(' â†’', ''); // Láº¥y text gá»‘c
            element.textContent = `${originalText} (${countdown}) â†’`;

            autoAdvanceTimer = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                    element.textContent = `${originalText} (${countdown}) â†’`;
                } else {
                    clearCountdown();
                    moveToNextScene();
                }
            }, 1000);
        }

        function advanceScene() {
            if (currentScene >= scenes.length - 1) return;

            scenes[currentScene].style.display = 'none'; // áº¨n cáº£nh hiá»‡n táº¡i
            currentScene++;
            const nextScene = scenes[currentScene];
            
            // Hiá»ƒn thá»‹ cáº£nh tiáº¿p theo trÆ°á»›c khi cháº¡y animation
            nextScene.style.display = 'block';
            nextScene.classList.remove('hidden');
            mainContainer.classList.remove('initial-entrance', 'scene-transition');
            void mainContainer.offsetWidth; // Trigger reflow to restart animation
            mainContainer.classList.add('scene-transition');

            startTypingForScene(nextScene);
        }

        // --- Logic cho nháº¡c ná»n ---
        function setupMusic() {
            musicControlBtn.addEventListener('click', () => {
                if (music.paused) {
                    music.play();
                    musicControlBtn.textContent = 'ğŸµ';
                } else {
                    music.pause();
                    musicControlBtn.textContent = 'ğŸ”‡';
                }
            });
        }

        // Cháº¡y hiá»‡u á»©ng khi trang Ä‘Æ°á»£c táº£i
        document.addEventListener('DOMContentLoaded', () => {
            // áº¨n táº¥t cáº£ cÃ¡c cáº£nh trá»« cáº£nh Ä‘áº§u tiÃªn
            scenes.forEach((scene, index) => {
                if (index !== 0) {
                    scene.classList.add('hidden');
                    scene.style.display = 'none';
                }
            });

            // ThÃªm sá»± kiá»‡n click cho phong bÃ¬
            envelopeContainer.addEventListener('click', () => {
                // ThÃªm class 'open' Ä‘á»ƒ cháº¡y animation má»Ÿ náº¯p
                envelopeContainer.classList.add('open');

                // Báº¯t Ä‘áº§u phÃ¡t nháº¡c khi ngÆ°á»i dÃ¹ng tÆ°Æ¡ng tÃ¡c láº§n Ä‘áº§u
                music.play().catch(e => console.log("Autoplay was prevented."));

                // Sau khi náº¯p má»Ÿ, áº©n phong bÃ¬ vÃ  hiá»‡n bá»©c thÆ°
                setTimeout(() => {
                    envelopeContainer.style.display = 'none';

                    mainContainer.style.visibility = 'visible';
                    mainContainer.style.opacity = '1';
                    mainContainer.classList.add('initial-entrance');
                    startTypingForScene(scenes[0]);
                }, 1000); // Giáº£m thá»i gian chá» sau khi bá» hiá»‡u á»©ng .letter
            }, { once: true }); // Chá»‰ cho phÃ©p click má»™t láº§n

            // CÃ i Ä‘áº·t nÃºt Ä‘iá»u khiá»ƒn nháº¡c
            setupMusic();
        });
    </script>
</body>
</html>